<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="stylesheet" href="/css/bulma.min.css" />
      <link rel="stylesheet" href="/fa/css/fontawesome.min.css" />
      <link rel="stylesheet" href="/fa/css/solid.min.css" />
      <style>
        :root {
          color-scheme: light;
        }
        @media (prefers-color-scheme: dark) {
          :root {
            color-scheme: dark;
          }
        }
      </style>
  </head>
  <body>
    <section class="section" style="min-height: 90vh;">
    <h2>Upload an Image/GIF</h2>
    <form id="uploadForm">
      <div class="file is-boxed">
  <label class="file-label">
    <input class="file-input" type="file" name="file" accept="image/*" id="fileInput"/>
    <span class="file-cta">
      <span class="file-icon">
        <i class="fas fa-upload"></i>
      </span>
      <span class="file-label"> Choose a fileâ€¦ </span>
    </span>
  </label>
</div>
      <button class="button is-primary" type="submit">Upload</button>
    </form>
    <div id="result" style="margin-top:1rem;"></div>
</section>
<footer class="footer">
  <div class="content has-text-centered">
    <p>
      Made at <strong>ERA Meth Lab</strong>
    </p>
  </div>
</footer>
    <script>
      const form = document.getElementById('uploadForm');
      const result = document.getElementById('result');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];
        if (!file) return alert('No file selected');

        const formData = new FormData();
        formData.append('file', file);

        try {
          const response = await fetch('/server/upload', {
            method: 'POST',
            body: formData,
          });

          const data = await response.json();
          if (data?.url) {
          result.innerHTML = `
            <p>File uploaded successfully!</p>
            <img src="${data.url}" style="max-width: 60vw; max-height: 60vw;" />
          `;
          } else {
            console.error("Upload failed")
          result.textContent = 'Upload failed';
          }
        } catch (err) {
          console.error('Upload failed', err);
          result.textContent = 'Upload failed';
        }
      });
    </script>
  </body>
</html>
